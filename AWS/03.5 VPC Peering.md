# VPC Peering Between Two AWS Accounts in Different Regions

This guide will walk you through creating a VPC peering connection between VPCs in two different AWS accounts and different regions. Note that inter-region VPC peering has some limitations (like no IPv6 support and no EC2 Classic instances).

## Prerequisites
- Two AWS accounts (Account A and Account B)
- Administrative access to both accounts
- VPCs already created in each account (we'll call them VPC-A and VPC-B)
- Different regions for each VPC (e.g., us-east-1 and eu-west-1)

## Step 1: Prepare Your VPCs

### In Account A (Requestor):
1. Note down:
   - VPC-A ID (e.g., vpc-12345678)
   - VPC-A CIDR block (e.g., 10.0.0.0/16)
   - Region (e.g., us-east-1)

### In Account B (Acceptor):
1. Note down:
   - VPC-B ID (e.g., vpc-87654321)
   - VPC-B CIDR block (e.g., 192.168.0.0/16)
   - Region (e.g., eu-west-1)
   
**Important:** Ensure the CIDR blocks don't overlap.

## Step 2: Create the VPC Peering Connection (From Account A)

1. Log in to Account A's AWS Management Console
2. Navigate to the VPC service in the region where VPC-A resides
3. In the left sidebar, click "Peering Connections"
4. Click "Create Peering Connection"
5. Configure:
   - Peering connection name tag: (e.g., "AccountA-to-AccountB")
   - Your VPC (VPC-A): Select your VPC from the dropdown
   - Account: Select "Another AWS account"
   - Account ID: Enter Account B's 12-digit AWS account ID
   - VPC (Account B): Enter VPC-B's ID (vpc-87654321)
   - Region: Select Account B's region (eu-west-1)
6. Click "Create Peering Connection"

## Step 3: Accept the VPC Peering Connection (In Account B)

1. Log in to Account B's AWS Management Console
2. Navigate to the VPC service in the region where VPC-B resides
3. In the left sidebar, click "Peering Connections"
4. Locate the pending peering connection (initiated by Account A)
5. Select it and click "Actions" â†’ "Accept Request"
6. Review the details and click "Accept"

## Step 4: Update Route Tables in Both Accounts

### In Account A (for VPC-A):
1. Navigate to "Route Tables" in the VPC dashboard
2. Select the route table associated with VPC-A
3. Click "Edit routes"
4. Add a new route:
   - Destination: VPC-B's CIDR (192.168.0.0/16)
   - Target: Select the peering connection (pcx-xxxxxx)
5. Click "Save routes"

### In Account B (for VPC-B):
1. Navigate to "Route Tables" in the VPC dashboard
2. Select the route table associated with VPC-B
3. Click "Edit routes"
4. Add a new route:
   - Destination: VPC-A's CIDR (10.0.0.0/16)
   - Target: Select the peering connection (pcx-xxxxxx)
5. Click "Save routes"

## Step 5: Update Security Groups (Optional but Recommended)

In both accounts, ensure your security groups allow traffic between the VPCs:

1. Navigate to "Security Groups" in the VPC dashboard
2. Select the security groups attached to your instances
3. Add inbound rules allowing traffic from the peer VPC's CIDR
   - For example, in Account A, allow 192.168.0.0/16
   - In Account B, allow 10.0.0.0/16

## Step 6: Test the Connection

1. Launch test instances in both VPCs (if not already present)
2. From an instance in VPC-A, try to ping an instance in VPC-B (private IP)
3. From an instance in VPC-B, try to ping back to VPC-A

## Important Notes

1. Inter-region peering has data transfer costs
2. DNS resolution across accounts requires additional configuration:
   - Enable DNS hostnames and DNS resolution in both VPCs
   - Modify the peering connection to enable DNS resolution
3. You cannot reference security groups from the peer VPC across regions
4. MTU is limited to 1500 bytes for inter-region peering

## Troubleshooting

If connectivity fails:
1. Verify route tables in both VPCs
2. Check security group and NACL settings
3. Ensure instances have proper private IPs within their VPC CIDR
4. Verify the peering connection shows as "Active" in both accounts
